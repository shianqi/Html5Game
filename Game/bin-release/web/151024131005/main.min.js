var Circle=function(t){function e(){t.call(this),this._radio=e.SIZE}__extends(e,t);var i=__define,s=e;return p=s.prototype,e.create=function(){return e.allCircles.length>0?e.allCircles.pop():new e},i(p,"index",function(){return this._index},function(t){this._index=t,this._bmp.texture=RES.getRes("number"+t)}),p.init=function(){this._bmp=new egret.Bitmap,this._bmp.width=2*e.SIZE,this._bmp.height=2*e.SIZE,this._bmp.x=-e.SIZE,this._bmp.y=-e.SIZE,this.addChild(this._bmp)},p.destroy=function(){this.visible=!0,e.allCircles.push(this)},e.SIZE=30,e.allCircles=[],e}(egret.Sprite);egret.registerClass(Circle,"Circle");var physics;!function(t){var e=function(){function t(t,e){this.collisions=[],this.velocity=new egret.Point,this._x=0,this._y=0,this.width=0,this.height=0,this.mass=0,this.debugColor=0,this.width=t,this.height=e}var e=__define,i=t;return p=i.prototype,p.onCollideDispatch=function(t,e,i,s){null!=this.onCollide&&this.onCollide(t,e,i,s)},p.onPersistDispatch=function(t,e,i){null!=this.onPersist&&this.onPersist(t,e,i)},p.onSeparateDispatch=function(t,e){null!=this.onSeparate&&this.onSeparate(t,e)},e(p,"x",function(){return this._x},function(t){this._x=t,this._showDebug&&(this._debugShape.x=this._x)}),e(p,"y",function(){return this._y},function(t){this._y=t,this._showDebug&&(this._debugShape.y=this._y)}),e(p,"showDebug",function(){return this._showDebug},function(t){this._showDebug!=t&&(this._showDebug=t,this._showDebug?null==this._debugShape&&(this._debugShape=new egret.Sprite,this._debugShape.graphics.beginFill(this.debugColor,.5),this._debugShape.graphics.drawRect(-this.width/2,-this.height/2,this.width,this.height),this._debugShape.graphics.endFill(),null!=this.debugContainer&&this.debugContainer.addChild(this._debugShape)):this._debugShape&&(null!=this.debugContainer&&this.debugContainer.removeChild(this._debugShape),this._debugShape.graphics.clear(),this._debugShape=null))}),t}();t.SimplePhysicsObject=e,egret.registerClass(e,"physics.SimplePhysicsObject")}(physics||(physics={}));var physics;!function(t){var e=function(t){function e(e,i){t.call(this,e,i),this.mass=1}__extends(e,t);var i=(__define,e);return p=i.prototype,e}(t.SimplePhysicsObject);t.DynamicPhysicsObject=e,egret.registerClass(e,"physics.DynamicPhysicsObject")}(physics||(physics={}));var physics;!function(t){var e=function(){function e(t){this._collideChecks=[],this._overlapChecks=[],this._scene=t}var i=__define,s=e;return p=s.prototype,p.collide=function(t,e){this._collideChecks.push({a:t,b:e})},p.overlap=function(t,e){this._overlapChecks.push({a:t,b:e})},p.tick=function(t){void 0===t&&(t=0);for(var e=this._collideChecks.length,i=0;e>i;i++){var s=this._collideChecks[i];if(s.a==s.b)throw new Error("CitrusSolver does not test collisions against objects of the same type.");for(var h=this._scene.getObjectsByType(s.a),n=0;n<h.length;++n)for(var o=h[n],r=this._scene.getObjectsByType(s.b),a=0;a<r.length;++a){var _=r[a];this.collideOnce(o,_)}}for(var c=this._overlapChecks.length,l=0;c>l;l++)if(s=this._overlapChecks[l],s.a==s.b){var d=this._scene.getObjectsByType(s.a);for(n=0;n<d.length;++n)for(o=d[n],a=n+1;a<d.length;++a)_=d[a],this.overlapOnce(o,_)}else for(h=this._scene.getObjectsByType(s.a),n=0;n<h.length;++n)for(o=h[n],r=this._scene.getObjectsByType(s.b),a=0;a<r.length;++a)_=r[a],this.overlapOnce(o,_)},p.collideOnce=function(e,i){var s=e.width/2+i.width/2-Math.abs(e.x-i.x);if(s>=0){var h=e.height/2+i.height/2-Math.abs(e.y-i.y);if(h>=0){var n,o;return h>s?(e.x<i.x?(e.x-=s,o=1,e.velocity.x>0&&(e.velocity.x=0)):(e.x+=s,o=-1,e.velocity.x<0&&(e.velocity.x=0)),n=Math.abs(i.velocity.x-e.velocity.x),e.collisions[i]?(e.collisions[i].type=t.SimpleCollision.PERSIST,e.collisions[i].impact=n,e.collisions[i].normal.x=o,e.collisions[i].normal.y=0,e.onPersistDispatch(e,i,e.collisions[i].normal),i.collisions[e].type=t.SimpleCollision.PERSIST,i.collisions[e].impact=-n,i.collisions[e].normal.x=-o,i.collisions[e].normal.y=0,i.onPersistDispatch(i,e,i.collisions[e].normal)):(e.collisions[i]=new t.SimpleCollision(e,i,new egret.Point(o,0),-n,t.SimpleCollision.BEGIN),e.onCollideDispatch(e,i,new egret.Point(o,0),-n),i.collisions[e]=new t.SimpleCollision(i,e,new egret.Point(-o,0),n,t.SimpleCollision.BEGIN),i.onCollideDispatch(i,e,new egret.Point(-o,0),n))):(e.y<i.y?(e.y-=h,o=1,e.velocity.y>0&&(e.velocity.y=0)):(e.y+=h,o=-1,e.velocity.y<0&&(e.velocity.y=0)),n=Math.abs(i.velocity.y-e.velocity.y),e.collisions[i]?(e.collisions[i].type=t.SimpleCollision.PERSIST,e.collisions[i].impact=n,e.collisions[i].normal.x=0,e.collisions[i].normal.y=o,e.onPersistDispatch(e,i,e.collisions[i].normal),i.collisions[e].type=t.SimpleCollision.PERSIST,i.collisions[e].impact=-n,i.collisions[e].normal.x=0,i.collisions[e].normal.y=-o,i.onPersistDispatch(i,e,i.collisions[e].normal)):(e.collisions[i]=new t.SimpleCollision(e,i,new egret.Point(0,o),-n,t.SimpleCollision.BEGIN),e.onCollideDispatch(e,i,new egret.Point(0,o),-n),i.collisions[e]=new t.SimpleCollision(i,e,new egret.Point(0,-o),n,t.SimpleCollision.BEGIN),i.onCollideDispatch(i,e,new egret.Point(0,-o),n))),!0}}return e.collisions[i]&&(e.onSeparateDispatch(e,i),delete e.collisions[i],i.onSeparateDispatch(i,e),delete i.collisions[e]),!1},p.overlapOnce=function(t,e){var i=t.x+t.width/2>=e.x-e.width/2&&t.x-t.width/2<=e.x+e.width/2&&t.y+t.height/2>=e.y-e.height/2&&t.y-t.height/2<=e.y+e.height/2;return i&&(t.onCollideDispatch(t,e,null,0),e.onCollideDispatch(e,t,null,0)),i},i(p,"tickEnable",void 0,function(t){this._tickEnable=t}),e}();t.SimplePhysicsSolver=e,egret.registerClass(e,"physics.SimplePhysicsSolver")}(physics||(physics={}));var Hero=function(t){function e(i,s){t.call(this,i,s),this._act=0,this._state=e.STATE_NORMAL,this._skin=new egret.Bitmap,this._skin.texture=RES.getRes("heroDown");var h=.75;this._skin.scaleX=h,this._skin.scaleY=h,this._skin.x=165,this._speakContainer=new egret.Sprite,this._txtSpeak=new egret.TextField,this._txtSpeak.textColor=0,this._txtSpeak.textAlign=egret.HorizontalAlign.CENTER,this._txtSpeak.size=18,this._speakContainer.addChild(this._txtSpeak),this._txtSpeak.y=1,this._speakContainer.x=200,this._skin.touchEnabled=!1,this._skin.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this)}__extends(e,t);var i=__define,s=e;return p=s.prototype,p.tapHandler=function(){this.sayDirty()},p.sayDirty=function(){this._txtSpeak.text="臭流氓";var t=18*this._txtSpeak.text.length,e=20;this._txtSpeak.width=t,this._speakContainer.graphics.clear(),this._speakContainer.graphics.beginFill(16777215),this._speakContainer.graphics.drawRoundRect(0,0,t,e,20,20),this._speakContainer.graphics.endFill(),this._container&&(this._speakContainer.x=(this._container.stage.stageWidth-t)/2,this._container.addChild(this._speakContainer))},p.say=function(){this._txtSpeak.text=this.getSay();var t=18*this._txtSpeak.text.length,e=20;this._txtSpeak.width=t,this._speakContainer.graphics.clear(),this._speakContainer.graphics.beginFill(16777215),this._speakContainer.graphics.drawRoundRect(0,0,t,e,20,20),this._speakContainer.graphics.endFill(),this._container&&(this._speakContainer.x=(this._container.stage.stageWidth-t)/2,this._container.addChild(this._speakContainer))},p.hideSay=function(){this._speakContainer.parent&&this._speakContainer.parent.removeChild(this._speakContainer)},p.getSay=function(){var t=["我是一只小小小肥鸟","让我达到HIGH点，我就嫁给你","讨厌啦，不要看人家的小内内","啊～偶的节操被弹掉了","好爽哦，根本停不下来有没有","左边的亲们，看偶的姿势美不美"],e=Math.floor(Math.random()*t.length);return t[e]},p.addTo=function(t,e){this._scene=t,this._container=e,t.add(this),e.addChild(this._skin)},i(p,"state",function(){return this._state},function(t){this._state!=t&&(this._state=t)}),p.up=function(){this._act!=e.ACT_UP&&this._act!=e.ACT_SUCCESS&&(this._skin.texture=RES.getRes("heroUp"),this._act=e.ACT_UP,this._skin.touchEnabled=!1)},p.down=function(){this._act!=e.ACT_DOWN&&(this._skin.texture=RES.getRes("heroDown"),this._act=e.ACT_DOWN,this.hideSay(),this._skin.touchEnabled=!0)},p.success=function(){if(this._act!=e.ACT_SUCCESS){this._act=e.ACT_SUCCESS;var t=Math.random(),i="heroUp";i=t>.8?"heroAct0":t>.6?"heroAct1":t>.4?"heroAct2":t>.2?"heroAct3":"heroPre",this._skin.texture=RES.getRes(i),this.say(),this._skin.touchEnabled=!1}},i(p,"y",function(){return this._y},function(t){this._y=t,this._showDebug&&(this._debugShape.y=this._y),this._skin.y=this._y-50,this._speakContainer.y=this._y-80}),e.STATE_NORMAL=0,e.STATE_GROUND=1,e.STATE_JUMP=2,e.ACT_DOWN=0,e.ACT_UP=1,e.ACT_SUCCESS=2,e}(physics.DynamicPhysicsObject);egret.registerClass(Hero,"Hero");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e);return p=i.prototype,p.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},p.setProgress=function(t,e){this.textField.text="游戏加载中..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=__define,s=e;return p=s.prototype,p.onAddToStage=function(){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/resource.json","resource/")},p.onConfigComplete=function(){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("preload")},p.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.createGameScene())},p.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},p.createGameScene=function(){this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("bg"),this._bg.width=this.stage.stageWidth,this._bg.height=this.stage.stageHeight,this.addChild(this._bg),this._state=-1,this.state=e.STATE_INTRO},i(p,"state",void 0,function(t){if(this._state!=t)switch(this._state=t,this._curState&&this._curState.parent&&this.removeChild(this._curState),this._state){case e.STATE_INTRO:this._curState=new StateIntro,this._curState.addEventListener("GameStart",this.gameStart,this),this.addChild(this._curState);break;case e.STATE_GAME:this._curState=new PhysicsTest,this._curState.addEventListener("GameOver",this.gameOver,this),this.addChild(this._curState);break;case e.STATE_OVER:this._curState=new StateOver,this._curState.addEventListener("GameStart",this.gameStart,this),this.addChild(this._curState)}}),p.gameStart=function(){this.state=e.STATE_GAME},p.gameOver=function(){this.state=e.STATE_OVER},e.STATE_INTRO=1,e.STATE_GAME=2,e.STATE_OVER=3,e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var MainUI=function(t){function e(){t.call(this),this.stage?this.init():this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=__define,s=e;return p=s.prototype,p.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},p.init=function(){this._txtScoreT=new egret.TextField,this._txtScore=new egret.TextField,this._txtLastJumpT=new egret.TextField,this._txtLastJump=new egret.TextField,this._txtScoreT.text="消耗热量：",this._txtScore.text="0",this._txtLastJumpT.text="剩余跳跃：",this._txtLastJump.text="10",this._txtScore.x=140,this._txtLastJumpT.y=30,this._txtLastJump.y=30,this._txtLastJump.x=140,this.addChild(this._txtScoreT),this.addChild(this._txtScore),this.addChild(this._txtLastJumpT),this.addChild(this._txtLastJump),this._score=0,this.score=0,this.jump=10},i(p,"score",function(){return this._score},function(t){this._score+=t,this._txtScore.text=this._score.toString(),e.totalScore=this._score}),i(p,"jump",void 0,function(t){this._jump=t,this._txtLastJump.text=this._jump.toString()}),e.totalScore=0,e}(egret.DisplayObjectContainer);egret.registerClass(MainUI,"MainUI");var physics;!function(t){var e=function(){function t(t,e,i,s,h){void 0===h&&(h=0),this.type=0,this.self=t,this.other=e,this.normal=i,this.impact=s,this.type=h}var e=(__define,t);return p=e.prototype,t.BEGIN=0,t.PERSIST=1,t}();t.SimpleCollision=e,egret.registerClass(e,"physics.SimpleCollision")}(physics||(physics={}));var physics;!function(t){var e=function(){function e(){this._len=0,this._gravity=.01,this._solver=new t.SimplePhysicsSolver(this),this._objs=new Array,this.collide(t.DynamicPhysicsObject,t.StaticPhysicsObject)}var i=__define,s=e;return p=s.prototype,i(p,"gravity",function(){return this._gravity},function(t){this._gravity=t}),p.add=function(t){this._objs.push(t),this._len++,this._debugShow&&(t.debugContainer=this._debugContainer,t.showDebug=!0)},p.remove=function(t){var e=this._objs.indexOf(t);-1!=e&&(this._objs.splice(e,1),this._len--),this._debugShow&&(t.showDebug=!1)},p.collide=function(t,e){this._solver.collide(t,e)},p.overlap=function(t,e){this._solver.overlap(t,e)},p.getObjectsByType=function(t){for(var e=new Array,i=0;i<this._len;i++)this._objs[i]instanceof t&&e.push(this._objs[i]);return e},i(p,"tickEnable",void 0,function(t){this._tickEnable=t}),p.tick=function(t){void 0===t&&(t=0);for(var e,i=0;i<this._len;i++)e=this._objs[i],e.mass>0&&(e.velocity.y+=this._gravity),e.x+=e.velocity.x*t,e.y+=e.velocity.y*t;this._solver.tick(t)},p.showDebug=function(t){this._debugContainer=t,this._debugShow=!0},e}();t.SimplePhysicsScene=e,egret.registerClass(e,"physics.SimplePhysicsScene")}(physics||(physics={}));var physics;!function(t){var e=function(t){function e(e,i){t.call(this,e,i)}__extends(e,t);var i=(__define,e);return p=i.prototype,e}(t.SimplePhysicsObject);t.StaticPhysicsObject=e,egret.registerClass(e,"physics.StaticPhysicsObject")}(physics||(physics={}));var PhysicsTest=function(t){function e(){t.call(this),this._speeds=[-.15,-.2,-.35],this.stage?this.init():this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},p.initUI=function(){this._ui=new MainUI,this.addChild(this._ui)},p.init=function(){var t=this.stage.stageWidth,i=this.stage.stageHeight;this._txtScore=new egret.TextField,this._txtScore.x=(t-this._txtScore.width)/2,this._txtScore.y=200,this._txtScore.text="开始",this._txtAdd=new egret.TextField,this._txtAdd.textColor=16776960,this._scene=new physics.SimplePhysicsScene,this._debugContainer=new egret.Sprite,this._ground=new physics.StaticPhysicsObject(t,100),this._ground.y=i-100,this._ground.x=t/2,this._bed=new egret.Bitmap,this._bed.texture=RES.getRes("bed0");var s=.75;this._bed.scaleX=s,this._bed.scaleY=s,this._bed.y=this._ground.y-100,this._bed.x=90,this._bedIn=new egret.Bitmap,this._bedIn.texture=RES.getRes("bedIn"),this._bedIn.scaleX=s,this._bedIn.scaleY=s,this._bedIn.y=this._ground.y-15+20,this._bedIn.x=138,this._bedIn.height=1,this.addChild(this._bed),this._opered=!0,this._hero=new Hero(50,50),this._hero.addTo(this._scene,this),this._scene.gravity=e.NORMAL_G,this._hero.x=t/2,this._hero.y=400,this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this._hero.onCollide=this.onCollide,this.addChild(this._bedIn),this._bedHalf=new egret.Bitmap,this._bedHalf.texture=RES.getRes("bedHalf"),this._bedHalf.scaleX=s,this._bedHalf.scaleY=s,this._bedHalf.y=this._ground.y-100,this._bedHalf.x=90,this.addChild(this._bedHalf),this._touchProxy=new TouchProxy,this._touchProxy.addEventListener(TouchProxyEvent.DOWN,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.UP,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.LEFT,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.RIGHT,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.RIGHT_UP,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.RIGHT_DOWN,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.LEFT_UP,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.LEFT_DOWN,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.POINT_THREE,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.POINT_TWO,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.POINT_FOUR,this.onTouchDown,this),this._touchProxy.addEventListener(TouchProxyEvent.TAB,this.onTouchDown,this),this.addChild(this._touchProxy),this._curSpeedIndex=0,this._lastTime=egret.getTimer(),this._groundY=i-200,this._lowOperY=this._groundY-50,this._highOperY=150,this._curLevel=0,this._curJump=0,this._comboo=0,this.initUI(),this.addChild(this._debugContainer)},p.addScore=function(t,e){this._txtAdd.text=e>1?"+"+t.toString()+" x"+e.toString()+" Comboo":"+"+t.toString(),this._txtAdd.alpha=1,this.addChild(this._txtAdd);var i=egret.Tween.get(this._txtAdd);this._txtAdd.y=this.stage.stageHeight/2,this._txtAdd.x=this.stage.stageWidth/2-50,i.to({y:this.stage.stageHeight/2-100,alpha:0},3e3)},p.onTouchDown=function(t){if(this._hero.state==Hero.STATE_GROUND&&t.type==TouchProxyEvent.TAB)this._curSpeedIndex+=2;else if(this._state==e.STATE_OPER&&!this._opered){if(t.type==TouchProxyEvent.TAB)return;this._opered=!0,t.type==this._touchProxy.type?(this.success(),this._hero.success()):this.fail(),this._touchProxy.hide()}},p.success=function(){this._successed=!0,this._txtScore.text="Successx"+this._comboo.toString()+" jump:"+this._curJump.toString(),this._curLevel++,this._comboo++,this._ui.score=this.getScore()},p.fail=function(){this._successed=!1,this._txtScore.text="Fail jump:"+this._curJump.toString(),this._comboo=0},p.gameOver=function(){this._txtScore.text="gameOver",this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this),this.dispatchEvent(new egret.Event("GameOver"))},p.onEnterFrame=function(){switch(this._curTime=egret.getTimer(),this._intervalTime=this._curTime-this._lastTime,this._lastTime=this._curTime,this._scene.tick(18),this._hero.state){case Hero.STATE_NORMAL:this._hero.velocity.y<0?(this._hero.up(),this._scene.gravity=e.NORMAL_G,this._hero.y<=this._lowOperY&&!this._opered&&this._curSpeedIndex>=2&&(this._touchProxy.show(),this._state=e.STATE_OPER),this._hero.y<=this._highOperY&&(this._touchProxy.hide(),this._state=e.STATE_NOOPER,this._opered||!this._successed&&this._curSpeedIndex>=2&&this.fail())):(this._hero.down(),this._scene.gravity=e.DOWN_G),this._hero.y>=this._groundY&&(this._scene.gravity=e.GROUND_G,this._hero.state=Hero.STATE_GROUND,this._hero.hideSay());break;case Hero.STATE_GROUND:this._bedIn.height=this._hero.y-this._groundY+20,this._hero.velocity.y<=0&&(console.log("jump",this._curSpeedIndex),this._scene.gravity=e.NORMAL_G,this._hero.state=Hero.STATE_JUMP,this._curSpeedIndex-=1,this._curSpeedIndex>2?this._curSpeedIndex=2:this._curSpeedIndex<0&&(this._curSpeedIndex=0),this._hero.velocity.y=this._speeds[this._curSpeedIndex],this._curSpeedIndex>=2?this._opered=!1:this._comboo=0,this._curJump++,this._ui.jump=e.MAX_JUMP-this._curJump,this._curJump>=e.MAX_JUMP&&this.gameOver());break;case Hero.STATE_JUMP:this._hero.y<this._groundY?this._hero.state=Hero.STATE_NORMAL:this._bedIn.height=this._hero.y-this._groundY+20,this._touchProxy.type=this.getTouchType(this._curLevel),this._successed=!1}},p.getScore=function(){var t=10*this._curLevel;return t+=Math.ceil(3*Math.random()),this.addScore(t,this._comboo),t*this._comboo},p.getTouchType=function(t){if(3>t){var e=Math.random();return e>.9?TouchProxy.UP:e>.8?TouchProxy.DOWN:e>.7?TouchProxy.LEFT:e>.6?TouchProxy.RIGHT:e>.45?TouchProxy.LEFT_UP:e>.3?TouchProxy.LEFT_DOWN:e>.15?TouchProxy.RIGHT_UP:TouchProxy.RIGHT_DOWN}return 3==t?TouchProxy.POINT_TWO:4==t?TouchProxy.POINT_THREE:TouchProxy.POINT_FOUR},p.onCollide=function(t){t.velocity.y=-.2},e.STATE_OPER=1,e.STATE_NOOPER=2,e.NORMAL_G=.002,e.DOWN_G=.006,e.GROUND_G=-.04,e.MAX_JUMP=10,e}(egret.Sprite);egret.registerClass(PhysicsTest,"PhysicsTest");var StateIntro=function(t){function e(){t.call(this),this.stage?this.init():this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},p.init=function(){this._btnStart=new egret.Sprite,this._btnStart.graphics.beginFill(16776960),this._btnStart.graphics.drawRect(0,0,200,100),this._btnStart.graphics.endFill(),this._btnStart.width=200,this._btnStart.height=100,this._btnStart.touchEnabled=!0,this._btnStart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this),this._btnStart.x=(this.stage.stageWidth-200)/2,this._btnStart.y=(this.stage.stageHeight-100)/2,this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("startPage"),this._bg.width=this.stage.stageWidth,this._bg.height=this.stage.stageHeight,this._bg.touchEnabled=!0,this._bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this),this.addChild(this._bg)},p.tapHandler=function(){this.dispatchEvent(new egret.Event("GameStart"))},e}(egret.DisplayObjectContainer);egret.registerClass(StateIntro,"StateIntro");var StateOver=function(t){function e(){t.call(this),this.stage?this.init():this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e);return p=i.prototype,p.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},p.init=function(){{var t=this.stage.stageWidth;this.stage.stageHeight}this._bg=new egret.Bitmap,this._bg.texture=RES.getRes("overPage"),this._bg.width=this.stage.stageWidth,this._bg.height=this.stage.stageHeight,this._bg.touchEnabled=!0,this._bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapHandler,this),this.addChild(this._bg),this._txt=new egret.TextField,this._txt.textColor=0,this._txt.textAlign=egret.HorizontalAlign.RIGHT,this._txt.width=300,this._txt.size=60,this._txt.text=MainUI.totalScore.toString(),this._txt.x=0,this._txt.y=215,this.addChild(this._txt),this._txtTitle=new egret.TextField,this._txtTitle.textColor=0,this._txtTitle.textAlign=egret.HorizontalAlign.CENTER,this._txtTitle.width=200,this._txtTitle.size=26,this._txtTitle.text=this.getTitle(),this._txtTitle.x=(t-this._txtTitle.width)/2,this._txtTitle.y=325,this.addChild(this._txtTitle)},p.tapHandler=function(){this.dispatchEvent(new egret.Event("GameStart"))},p.getText=function(){var t=68.9;return t=MainUI.totalScore>1500?10*Math.random()+90:MainUI.totalScore>1e3?10*Math.random()+80:MainUI.totalScore>500?10*Math.random()+70:10*Math.random()+60,0==MainUI.totalScore&&(t=0),t=Math.floor(100*t)/100,"恭喜你获得了总分\n"+MainUI.totalScore.toString()+"\n击败了全国"+t.toString()+"%的玩家\n获得了称号\n“"+this.getTitle()+"”"},p.getTitle=function(){var t=["烧鸡达人","金牌减肥教练","贱贱的笑了","猪是念来过倒","药不能停","最佳备胎"],e=Math.floor(Math.random()*t.length);return t[e]},e}(egret.DisplayObjectContainer);egret.registerClass(StateOver,"StateOver");var TouchProxy=function(t){function e(){t.call(this),this.stage?this.init():this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=__define,s=e;return p=s.prototype,p.show=function(){this._view&&!this._view.parent&&(this.stage&&(this._view.x=this.stage.stageWidth/2,this._view.y=this.stage.stageHeight/2),this.addChild(this._view))},p.hide=function(){this._view&&this._view.parent&&this.removeChild(this._view),this.clear(),this._type=""},i(p,"type",function(){return this._type},function(t){if(this._type!=t)switch(this._type=t,this._arrow||this.createArrow(),this._view=this._arrow,this._type){case e.UP:this._arrow.rotation=-90,this._viewW=100,this._viewH=300;break;case e.DOWN:this._arrow.rotation=90,this._viewW=100,this._viewH=300;break;case e.LEFT:this._arrow.rotation=180,this._viewW=300,this._viewH=100;break;case e.RIGHT:this._arrow.rotation=0,this._viewW=300,this._viewH=100;break;case e.LEFT_UP:this._arrow.rotation=-135,this._viewW=240,this._viewH=240;break;case e.LEFT_DOWN:this._arrow.rotation=135,this._viewW=240,this._viewH=240;break;case e.RIGHT_UP:this._arrow.rotation=-45,this._viewW=240,this._viewH=240;break;case e.RIGHT_DOWN:this._arrow.rotation=45,this._viewW=240,this._viewH=240;break;case e.POINT_THREE:this._curTabIndex=1,this.createPoint(3),this._view=this._circleContainer,this._viewW=this._circleContainer.width,this._viewH=this._circleContainer.height;break;case e.POINT_TWO:this._curTabIndex=1,this.createPoint(2),this._view=this._circleContainer,this._viewW=this._circleContainer.width,this._viewH=this._circleContainer.height;break;case e.POINT_FOUR:this._curTabIndex=1,this.createPoint(4),this._view=this._circleContainer,this._viewW=this._circleContainer.width,this._viewH=this._circleContainer.height}}),p.createArrow=function(){this._arrow=new egret.Sprite,this._arrow.graphics.lineStyle(10,16777113),this._arrow.graphics.moveTo(-150,0),this._arrow.graphics.lineTo(150,0),this._arrow.graphics.moveTo(50,-50),this._arrow.graphics.lineTo(150,0),this._arrow.graphics.moveTo(50,50),this._arrow.graphics.lineTo(150,0),this._arrow.alpha=.7},p.hitTestCircle=function(t,e){var i,s,h,n,o=0,r=this._pointCircles.length,a=Circle.SIZE*Circle.SIZE;for(o=0;r>o;o++)if(i=this._pointCircles[o],s=i.x-t,h=i.y-e,n=s*s+h*h,a>n)return i.visible=!1,i.index;return-1},p.createPoint=function(t){for(var i,s,h=0;t>h;h++){var n=Circle.create();for(i=e.POINT_CONTAINER_SIZE/2-Math.random()*e.POINT_CONTAINER_SIZE,s=e.POINT_CONTAINER_SIZE/2-Math.random()*e.POINT_CONTAINER_SIZE;!this.checkRadio(i,s);)i=e.POINT_CONTAINER_SIZE/2-Math.random()*e.POINT_CONTAINER_SIZE,s=e.POINT_CONTAINER_SIZE/2-Math.random()*e.POINT_CONTAINER_SIZE;n.x=i,n.y=s,n.init(),n.index=h+1,this._pointCircles.push(n),this._circleContainer.addChild(n)}},p.checkRadio=function(t,e){var i,s,h,n,o=0,r=this._pointCircles.length,a=Circle.SIZE*Circle.SIZE*4;for(o=0;r>o;o++)if(i=this._pointCircles[o],s=i.x-t,h=i.y-e,n=s*s+h*h,a>n)return!1;return!0},p.clear=function(){if(this._pointCircles.length>0){for(var t=0,e=this._pointCircles.length;e>t;t++)this._pointCircles[t].destroy();this._circleContainer.removeChildren(),this._pointCircles.length=0}},p.onAddToStage=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.init()},p.init=function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this),this._pointCircles=[],this._circleContainer=new egret.DisplayObjectContainer,this._curTabIndex=1},p.touchHandler=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._startX=t.localX,this._startY=t.localY,this._startStageX=t.stageX,this._startStageY=t.stageY;break;case egret.TouchEvent.TOUCH_END:if(this._endX=t.localX,this._endY=t.localY,this._endStageX=t.stageX,this._endStageY=t.stageY,this.dispatchEvent(this._endX>this._startX+100?this._endY>this._startY+100?new TouchProxyEvent(TouchProxyEvent.RIGHT_DOWN):this._endY<this._startY-100?new TouchProxyEvent(TouchProxyEvent.RIGHT_UP):new TouchProxyEvent(TouchProxyEvent.RIGHT):this._endX<this._startX-100?this._endY>this._startY+100?new TouchProxyEvent(TouchProxyEvent.LEFT_DOWN):this._endY<this._startY-100?new TouchProxyEvent(TouchProxyEvent.LEFT_UP):new TouchProxyEvent(TouchProxyEvent.LEFT):this._endY>this._startY+100?new TouchProxyEvent(TouchProxyEvent.DOWN):this._endY<this._startY-100?new TouchProxyEvent(TouchProxyEvent.UP):new TouchProxyEvent(TouchProxyEvent.TAB)),this._type==e.POINT_THREE||this._type==e.POINT_TWO||this._type==e.POINT_FOUR){var i=this.hitTestCircle(this._endX-this._view.x,this._endY-this._view.y);i==this._curTabIndex&&(2==i&&this._type==e.POINT_TWO&&this.dispatchEvent(new TouchProxyEvent(TouchProxyEvent.POINT_TWO)),3==i&&this._type==e.POINT_THREE&&this.dispatchEvent(new TouchProxyEvent(TouchProxyEvent.POINT_THREE)),4==i&&this._type==e.POINT_FOUR&&this.dispatchEvent(new TouchProxyEvent(TouchProxyEvent.POINT_FOUR)),this._curTabIndex++)}}},p.destroy=function(){this.stage&&(this.stage.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchHandler,this),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.touchHandler,this))},e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.RIGHT_UP="RIGHT_UP",e.RIGHT_DOWN="RIGHT_DOWN",e.LEFT_UP="LEFT_UP",e.LEFT_DOWN="LEFT_DOWN",e.TAB="TAB",e.POINT_THREE="POINT_THREE",e.POINT_TWO="POINT_TWO",e.POINT_FOUR="POINT_FOUR",e.POINT_CONTAINER_SIZE=250,e}(egret.DisplayObjectContainer);egret.registerClass(TouchProxy,"TouchProxy");var TouchProxyEvent=function(t){function e(e,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1),t.call(this,e,i,s)}__extends(e,t);var i=(__define,e);return p=i.prototype,e.UP="UP",e.DOWN="DOWN",e.LEFT="LEFT",e.RIGHT="RIGHT",e.RIGHT_UP="RIGHT_UP",e.RIGHT_DOWN="RIGHT_DOWN",e.LEFT_UP="LEFT_UP",e.LEFT_DOWN="LEFT_DOWN",e.TAB="TAB",e.POINT_THREE="POINT_THREE",e.POINT_TWO="POINT_TWO",e.POINT_FOUR="POINT_FOUR",e}(egret.Event);egret.registerClass(TouchProxyEvent,"TouchProxyEvent");